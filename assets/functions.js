let inventoryLoaded=!1,inventoryArray=[],checkInterval,checkHudInterval;const imageBlobToNameMap=new Map([[876,"mine"],[791,"coop"],[1210,"hutch"],[832,"apiary"]]);let imageHashMap,userPremium;function mainInterval(e,t){let r,n,l=!1;function c(){let e=document.querySelectorAll(nodeNames.hudTopLeft);e.length>0&&(clearInterval(checkHudInterval),setTimeout(a,400),r=new Date)}imageHashMap=t,userPremium=e;var o=0;function a(){var e=Date.now();e-o>2e3&&(loadInventoryPrices(),o=e),checkHudInterval=setInterval(()=>{let e=document.querySelectorAll(nodeNames.hudTopLeft);if(0===e.length)clearInterval(checkHudInterval),checkHudInterval=setInterval(c,100);else{var t=Date.now();if(!location.href.endsWith("/gridcraft")){let a=document.querySelectorAll(".voxels-inventory-price");0===a.length&&t-o>1e4&&(loadInventoryPrices(),o=t)}n=checkForWindow(n,nodeNames.market_place,".voxels-market-create-price",fetchMarketPrices),checkForAboutPage(),userPremium?(l=checkForWindow(l,nodeNames.tasksCard,".voxels-tasks-prices",addTaskPrices),checkInventoryChange(),checkEnergyChange(),l&&checkTasks()):loadTasksF&&(l=checkForWindow(l,nodeNames.tasksCard,".voxels-tasks-prices",addTaskPrices))&&checkTasks();let i=new Date,u=(i-r)/1e3;u>=50&&(r=new Date,loadInventoryPrices(),n&&fetchMarketPrices(".voxels-market-create-price"),l&&addTaskPrices(".voxels-tasks-prices"),userPremium&&(setTasksCost(),fetchItemListPrices(uniqueItemNamesList)))}},500)}checkHudInterval=setInterval(c,100)}function checkForWindow(e,t,r,n){let l=document.querySelectorAll(t);if(e){if(0===l.length)return!1;let c=document.querySelectorAll(r);return 0===c.length&&n(r),!0}return l.length>0&&(n(r),!0)}function checkInventoryChange(){let e=getCurrentInventory(!1);if(0===inventoryArray.length||0===e.length){inventoryArray=e;return}let t=compareInventories(inventoryArray,e);!1!==t?(startTimerType(t),inventoryArray=getCurrentInventory(!0)):inventoryArray=e}function getCurrentInventory(e){let t=document.querySelectorAll(nodeNames.hudItems),r=[];return t.forEach(t=>{let n=t.querySelector(nodeNames.hudItemImage),l=t.querySelector(nodeNames.hudQuantities),c=parseInt(t.querySelector(nodeNames.hudShortcut).textContent)-1;if(n&&l&&e){let o=n.src;fetch(o,{method:"GET"}).then(e=>e.headers.get("Content-Length")).then(e=>{let t=l.textContent.replace("x",""),n=parseInt(t)||1;r[c]={length:e,quantity:n}}).catch(e=>console.error("Error fetching blob:",e))}else if(l){let a=l.textContent.replace("x",""),i=parseInt(a)||1;r[c]={length:null,quantity:i}}else r[c]=null}),r}function compareInventories(e,t){for(let r=0;r<t.length;r++){let n=t[r],l=e[r];if(null!==n&&(null===l&&n.quantity>=1&&n.quantity<=10||null!==l&&n.quantity>l.quantity&&n.quantity<=l.quantity+10)){let c=fetchImageAndCheckContent(r);if(!1!==c)return c}}return!1}function fetchImageAndCheckContent(e){let t=[].slice.call(document.querySelectorAll(nodeNames.hudShortcut)).filter(function(t){return t.innerHTML.trim()===String(e+1)}),r=t[0].parentElement,n=r.querySelector(nodeNames.hudItemImage);if(n){let l=calculateAverageColor(n);if(imageHashMap[l])return imageHashMap[l]}return!1}function isEqual(e,t){return JSON.stringify(e)===JSON.stringify(t)}