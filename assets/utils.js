async function makeFetchRequest(e,t,a="POST"){try{let{userStatus:l,user_acde:o}=await new Promise(e=>{chrome.storage.local.get(["userStatus","user_acde"],function(t){e(t)})});if(!l||!o)return chrome.storage.local.clear(function(){}),"logout";t.user_acde=o,t.version=version;let s=await fetch(e,{method:a,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)});if(200!==s.status)throw Error("fail");let n=await s.json();return n}catch(i){throw console.log(i),i}}async function makeFetchRequestByPID(e,t,a="POST"){try{let{pid:l,user_acde:o}=await new Promise(e=>{chrome.storage.local.get(["pid","user_acde"],function(t){e(t)})});if(!l||!o)return chrome.storage.local.clear(function(){}),"logout";t.user_acde=o,t.version=version;let s=await fetch(e,{method:a,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)});if(200!==s.status)throw Error("fail");let n=await s.json();return n}catch(i){throw console.log(i),i}}async function makeRequestToTools(e,t="POST"){try{let{pid:a,user_acde:l}=await new Promise(e=>{chrome.storage.local.get(["pid","user_acde"],function(t){e(t)})});if(!a||!l)return chrome.storage.local.clear(function(){}),"logout";e.user_acde=l,e.version=version;let o=await fetch(toolsURL,{method:t,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(e)});if(200!==o.status)throw Error("fail");let s=await o.json();return s}catch(n){throw console.log(n),n}}function debugLog(e){console.log("Voxels: "),console.log(e)}function handleErrors(e){if(e&&e.data&&e.data.error){switch(e.data.error){case"2001":showAlert("You've already added this location","error");break;case"2003":showAlert("You have to be ingame to add locations.","error");break;case"2006":showAlert("Currently only terravilla and farms can be added. More coming soon!","error");break;case"2007":break;case"2008":showAlert("This farm already exists at this location.","error");break;case"3006":showAlert("You have reached the maximum number of farms.","error");break;case"4006":showAlert("You have reached the maximum number of storages.","error");break;case"7001":showAlert("Too fast.","error");break;case"7002":showAlert("No new transaction found. Please retry in 10s","error");break;case"8001":displayInfo({title:"Update!",rows:[{text:"Voxels has received an update. Please reload this page."}]});break;case"8002":showAlert(e.data.text,"info");break;case"not_premium_playerpage":showPlayerPagePremium();break;default:showAlert(e.data.error,"error")}return loadingScreenFull(0),!0}return!1}function showAlert(e,t){var a=document.querySelector(".voxels-popup");a&&a.remove();var l=document.createElement("div");switch(l.className="voxels-popup",t){case"error":l.innerHTML+="<h3>Voxels Error:</h3><p>"+e+"</p>";break;case"info":l.innerHTML+="<h3>Voxels:</h3><p>"+e+"</p>",l.classList.add("voxels-popup-info");break;case"success":l.innerHTML+="<h3>Voxels:</h3><p>"+e+"</p>",l.classList.add("voxels-popup-success");break;default:l.innerHTML+="<h3>Voxels:</h3><p>"+e+"</p>"}var o=document.createElement("div");o.className="voxels-popup-close",o.innerHTML="X",l.appendChild(o),document.body.appendChild(l),o.addEventListener("click",function(){l.remove()}),setTimeout(function(){l.style.opacity="0",setTimeout(function(){l.remove()},1e3)},5e3)}function quickMessage(e,t){let a=3e3;"news"==t&&(a=6e3);var l=document.querySelector(".voxels-quick-message-popup");l&&l.remove();var o=document.createElement("div");o.className="voxels-quick-message-popup voxels-"+t,o.innerHTML='<p>Voxels:</p><p class="voxels-quick-info">'+e+'</p><div class="voxels-progress-bar"></div>',document.body.appendChild(o);var s=document.createElement("div");s.className="dismiss-pop-up clickable",s.innerText="X",o.appendChild(s),o.querySelector(".voxels-progress-bar").style.animation="voxels-progressBarAnimation "+a/1e3+"s linear forwards",s.addEventListener("click",function(){o.remove()}),setTimeout(function(){o.style.animation="0.5s ease 0s 1 normal forwards running voxels-slideOut",setTimeout(function(){o.remove()},500)},a)}function convertArrayToObject(e){let t={};return e.forEach((e,a)=>{t[a]=e}),t}function reloadVoxels(){var e=document.querySelector(".voxels-main-container");e&&e.parentNode.removeChild(e),startLoad()}function nFormatter(e,t){let a=e<0;e=Math.abs(e);let l=[{value:1,symbol:""},{value:1e3,symbol:"K"},{value:1e6,symbol:"M"},{value:1e9,symbol:"B"},{value:1e12,symbol:"T"},{value:1e15,symbol:"Q"},{value:1e18,symbol:"Q"}].findLast(t=>e>=t.value),o=l?(e/l.value).toFixed(t).replace(/\.0+$|(?<=\.[0-9]*[1-9])0+$/,"").concat(l.symbol):"0";return a&&(o="-"+o),o}function parseFormattedAmount(e){"string"!=typeof e&&(e=String(e));let t=e.match(/^([\d\.]+)([KMBT]?)$/);if(!t)return NaN;let a=parseFloat(t[1]),l=t[2];return Math.round(a*(({K:1e3,M:1e6,B:1e9,T:1e12})[l]||1))}function loadingScreen(e){let t=document.querySelector("#voxels-main-modal"),a=document.querySelector(".voxels-main"),l=document.createElement("div");if(l.id="voxels-loading-div",l.classList.add("voxels-loading"),1===e)l.innerHTML='<div class="voxels-loader"></div>',a.appendChild(l),t.style.filter="brightness(0.5)";else{let o=document.getElementById("voxels-loading-div");o&&a.removeChild(o),t.style.filter=""}}function loadingScreenFull(e){let t=document.querySelector("#voxels-full-page"),a=document.createElement("div");if(a.id="voxels-loading-div",a.classList.add("voxels-loading"),1===e)a.innerHTML='<div class="voxels-loader"></div>',t.appendChild(a),t.style.filter="brightness(0.5)";else{let l=document.getElementById("voxels-loading-div");l&&t.removeChild(l),t.style.filter=""}}let dragEl,dragHandleEl,dragging=!1;const lastPosition={};let dragBoundaries;function setupDraggable(){(dragHandleEl=document.querySelector("[data-drag-handle]")).addEventListener("mousedown",dragStart),document.addEventListener("mouseup",dragEnd)}function dragStart(e){0===e.button&&(dragging=!0,(dragEl=getDraggableAncestor(e.target)).style.setProperty("position","absolute"),lastPosition.left=e.target.clientX,lastPosition.top=e.target.clientY,dragHandleEl.classList.add("dragging"),document.addEventListener("mousemove",dragMove))}function dragMove(e){if(1!==e.buttons)return;let t=dragEl.getBoundingClientRect(),a=t.left+e.clientX-lastPosition.left,l=t.top+e.clientY-lastPosition.top,o=window.innerWidth-t.width,s=window.innerHeight-t.height,n=Math.max(0,Math.min(a,o)),i=Math.max(0,Math.min(l,s));dragEl.style.setProperty("left",`${n}px`),dragEl.style.setProperty("top",`${i}px`),lastPosition.left=e.clientX,lastPosition.top=e.clientY,window.getSelection().removeAllRanges(),(0===n||n===o||0===i||i===s)&&0===e.buttons&&dragEnd()}function getDraggableAncestor(e){return e.getAttribute("data-draggable")?e:getDraggableAncestor(e.parentElement)}function dragEnd(){if(dragging){dragHandleEl.classList.remove("dragging"),document.removeEventListener("mousemove",dragMove),dragEl=null,dragging=!1;var e=document.getElementById("voxels-main-modal"),t={};t.top=e.style.top,t.left=e.style.left,chrome.storage.local.set({modalPosition:t})}}function responsiveDraggableReset(){var e=document.getElementById("voxels-main-modal");window.innerWidth>540?(e.style.top="70px",e.style.left="20px"):(e.style.top="50%",e.style.left="50%")}function inputWithCallback(e,t){var a=document.createElement("div");a.className="voxels-popup-input",a.innerHTML="<h3>"+e+'</h3><input type="text" id="inputField"><button id="submitButton">OK</button>',a.classList.add("voxels-popup-info");var l=a.querySelector("#inputField");l.addEventListener("keydown",function(e){document.activeElement===l&&(e.stopPropagation(),"Enter"===e.key&&document.getElementById("submitButton").click())});var o=document.createElement("div");o.className="voxels-popup-close",o.innerHTML="X",a.appendChild(o),document.body.appendChild(a),o.addEventListener("click",function(){a.remove()}),document.getElementById("inputField").focus(),document.getElementById("submitButton").addEventListener("click",function(){var e=document.getElementById("inputField").value.trim();""===e?showAlert("Please enter some input.","error"):(t(e),a.remove())})}function limiter(e,t){let a=0;return function(...l){let o=Date.now();if(o-a>=t)return e(...l),a=o,!0;{let s=Math.round((t-(o-a))/1e3);return quickMessage("Please wait "+s+"s...","error"),!1}}}function voxelsConfirm(e,t){var a=document.createElement("div");a.classList.add("voxels-popup-storage","voxels-popup-info"),a.innerHTML="<h3>"+e+'</h3><button id="confirmButton">Yes</button>';var l=document.createElement("div");function o(){a.remove()}l.className="voxels-popup-close",l.innerHTML="X",a.appendChild(l),document.body.appendChild(a),l.addEventListener("click",o),document.getElementById("confirmButton").addEventListener("click",function(){t(!0),o()})}function openFullpage(){document.body.classList.contains("js-voxels-main-modal-active")&&document.body.classList.toggle("js-voxels-main-modal-active");let e=document.querySelector("#voxels-full-page");e.style.display="flex",fullPageActive=!0}function closeFullpage(){let e=document.querySelector("#voxels-full-page");e.style.display="none",fullPageActive=!1}function showFullOverlay(){let e=document.querySelector("#voxels-full-page-overlay");e.style.display="block"}function hideFullOverlay(){let e=document.querySelector("#voxels-full-page-overlay");e.style.display="none"}function toggleNotifications(){if(premium)return quickMessage("Nofications "+((notifications=!notifications)?"On":"Off"),"info"),chrome.storage.local.set({notifications:notifications}),!0}function toggleStorageHover(){return quickMessage("Storage Hover "+((displayStorageHover=!displayStorageHover)?"On":"Off"),"info"),chrome.storage.local.set({storageHover:displayStorageHover}),!0}function toggleTaskboardDisplay(){return quickMessage("Taskboard style: "+((taskboardTiles=!taskboardTiles)?"Minimal":"Detailed"),"info"),chrome.storage.local.set({taskboardTiles:taskboardTiles}),loadTasks(0),!0}function toggleVoxels(){voxelsDisplayed=!voxelsDisplayed;let e=document.body,t=document.querySelector("#voxels-main-nav"),a=document.querySelector("#voxels-toggle-voxels-button");return voxelsDisplayed?(t.style.display="flex",a.style.display="none",e.classList.add("js-voxels-main-modal-active")):(t.style.display="none",a.style.display="flex",e.classList.remove("js-voxels-main-modal-active")),chrome.storage.local.set({voxelsDisplayed:voxelsDisplayed}),!0}function initCustomSelect(){var e=document.querySelector(".voxels-custom-select-selected"),t=document.querySelector(".voxels-custom-select-items"),a=t.querySelectorAll("li");e.addEventListener("click",function(){t.classList.toggle("voxels-custom-select-hide"),e.classList.toggle("voxels-custom-select-arrow-active"),e.classList.toggle("voxels-custom-select-arrow-inactive")}),a.forEach(function(a){a.addEventListener("click",function(){e.textContent=this.textContent,e.setAttribute("data-select",this.textContent),t.classList.add("voxels-custom-select-hide"),e.classList.remove("voxels-custom-select-arrow-active"),e.classList.add("voxels-custom-select-arrow-inactive")})}),document.addEventListener("click",function(a){e.contains(a.target)||(t.classList.add("voxels-custom-select-hide"),e.classList.remove("voxels-custom-select-arrow-active"),e.classList.add("voxels-custom-select-arrow-inactive"))})}function toggleItems(e){e.currentTarget.closest(".voxels-playerpage-info-subsection").querySelectorAll(".voxels-playerpage-info-row").forEach((e,t)=>{e.classList.contains("js-visible")?e.classList.remove("js-visible"):setTimeout(()=>{e.classList.add("js-visible")},100*t)})}function loadPlayerPageTop(){openFullpage();var e=document.getElementById("voxels-full-page-main");e.innerHTML="";var t=document.createElement("div");t.setAttribute("id","voxels-player-home");var a=document.createElement("div");a.classList.add("voxels-player-top-row");var l=document.createElement("img");l.src=chrome.runtime.getURL("images/icons/icon__house.svg"),l.classList.add("voxels-player-home-icon","clickable"),l.onclick=function(){loadLeaderboardPage("overall")},a.appendChild(l);var o=document.createElement("div");o.classList.add("voxels-player-input-container");var s=document.createElement("input");s.setAttribute("type","text"),s.setAttribute("placeholder","Enter username, id or wallet..."),s.classList.add("voxels-player-input"),s.setAttribute("autocomplete","off");var n=document.createElement("button");n.setAttribute("id","playerSubmitButton"),n.innerHTML="&#8594;",n.classList.add("voxels-player-submit-button");let i=limiter(function(e){searchPlayer(e)},5e3);n.onclick=function(){s.value.length<=45?i(s.value):quickMessage("Please check your input","error")},s.addEventListener("keydown",function(e){document.activeElement===s&&(e.stopPropagation(),"Enter"===e.key&&document.getElementById("playerSubmitButton").click())}),o.appendChild(s),o.appendChild(n),a.appendChild(o),t.appendChild(a);var r=document.createElement("div");r.setAttribute("id","voxels-player-main-area"),r.classList.add("voxels-scroll"),t.appendChild(r),e.appendChild(t),switchFullPageNav("player")}function loadGuildPageTop(){var e=document.getElementById("voxels-full-page-main");e.innerHTML="";var t=document.createElement("div");t.setAttribute("id","voxels-guild-home");var a=document.createElement("div");a.classList.add("voxels-guild-top-row");var l=document.createElement("img");l.src=chrome.runtime.getURL("images/icons/icon__house.svg"),l.classList.add("voxels-guild-home-icon","clickable"),l.addEventListener("click",function(){loadGuildsPage()}),a.appendChild(l),t.appendChild(a);var o=document.createElement("div");o.setAttribute("id","voxels-guild-main-area"),o.classList.add("voxels-scroll"),t.appendChild(o),e.appendChild(t),switchFullPageNav("guilds")}function switchFullPageNav(e){let t=document.querySelectorAll(".voxels-full-nav-item");t.forEach(e=>{e.classList.remove("active")});let a=Array.from(t).find(t=>t.textContent.toLowerCase()===e);a&&a.classList.add("active"),activeFullPage=e}onPlayPixels&&window.addEventListener("resize",function(){responsiveDraggableReset()},!0);let currentPricesList=[];function fetchItemListPrices(e){e.length>1&&chrome.storage.local.get("pid",async function(t){let a=t.pid;try{let l=await makeFetchRequestByPID(apiURL,{pid:a,operation:"retrieveItems",extra:e});currentPricesList=l.data,firstLoadForPet&&(previousPetInventory=null,firstLoadForPet=!1)}catch(o){reject(o)}})}const getImageForItem=e=>{let t=displayNamesJSONArray.find(t=>t.item===e);return t?t.image:""},getNameForItem=e=>{let t=displayNamesJSONArray.find(t=>t.item===e);return t?t.display_name:e},getItmByName=e=>{let t=displayNamesJSONArray.find(t=>t.display_name===e);return t?t.item:null};function mapItmToNameAndImage(e){return e.map(e=>{let t=displayNamesJSONArray.find(t=>t.item===e);return t?{item:e,image:t.image,displayName:t.display_name}:{item:e,image:"https://pixels-api.com/images/item_not_found.png",displayName:"Item not identified"}})}const findRecipe=e=>{let t=craftingRecipesJSONArray.find(t=>t.item===e);return t?t.requiredItems:null};