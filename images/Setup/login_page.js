!function(){let e=!0,t=!1,n=!1,s=[],a=[],i=[];window.postMessage({type:"VOXELS_INITIATED"}),window.addEventListener("message",(n=>{n.source===window&&(n.data.type&&"VOXELS_SET_INSTANCE_ACTIVE"===n.data.type?e=n.data.value:n.data.type&&"VOXELS_AUTH_SUCCESSFUL"===n.data.type?t=n.data.value:n.data.type&&"VOXELS_SEARCH_ENTITIES"===n.data.type?s=n.data.data:n.data.type&&"VOXELS_ACTIVE_TIMERS"===n.data.type?a=n.data.data:n.data.type&&"VOXELS_PUBLIC_LANDS"===n.data.type&&(i=n.data.data))})),voxelsCheckHudInterval=setInterval((function(){document.querySelectorAll(".Hud_topLeftBackground__OhgQS").length>0&&(clearInterval(voxelsCheckHudInterval),n||function(e,t){let n=15e3;"news"==t&&(n=6e3);var s=document.querySelector(".voxels-quick-message-popup");s&&s.remove();var a=document.createElement("div");a.className="voxels-quick-message-popup voxels-"+t,a.innerHTML='<p>Voxels:</p><p class="voxels-quick-info">'+e+'</p><div class="voxels-progress-bar"></div>',document.body.appendChild(a);var i=document.createElement("div");i.className="dismiss-pop-up clickable",i.innerText="X",a.appendChild(i),a.querySelector(".voxels-progress-bar").style.animation="voxels-progressBarAnimation "+n/1e3+"s linear forwards",i.addEventListener("click",(function(){a.remove()})),setTimeout((function(){a.style.animation="0.5s ease 0s 1 normal forwards running voxels-slideOut",setTimeout((function(){a.remove()}),500)}),n)}("Error loading Voxels. Please reload Pixels","error"))}),100);let r="gachaOpened",o="mb_b";function l(e){return e&&"object"==typeof e?Object.entries(e).reduce(((e,[t,n])=>("object"==typeof n&&null!==n?Object.entries(n).forEach((([n,s])=>{e[`${t}_${n}`]=s})):e[t]=n,e)),{}):e}let c=".Hud_topLeftBackground__OhgQS";let u="";function d(e){return e&&Array.isArray(e)?e.reduce(((e,t)=>(e[t.name]=t.numeric?parseFloat(t.value):t.value,e)),{}):{}}!function e(t){if(void 0!==window.Phaser){const e=window.Phaser,n=e.Game;const s=new Proxy(n,{construct:function(e,n){const s=new e(...n);return t(s),s}});e.Game=s}else setTimeout((()=>e(t)),10)}((function(m){let p=null;!function f(){if(n=!0,!m)return;const y=m.scene.scenes[1];if(y){if(e){const e=m.scene.scenes[1].selfPlayer.playerData.label;window.postMessage({type:"VOXELS_PLAYER_LABEL",label:e})}if(!t)return void setTimeout(f,200);if(y.__cameraMonitorSetup||(!function(e){const t=e.cameras.main,n=1e3/60,s=500;let{x:a,y:i}=t.worldView,r=t.zoom;const o=t.worldView,l=()=>window.postMessage({type:"CAMERA_CHANGE",data:{height:o.height,width:o.width,bottom:o.y+o.height,top:o.y,left:o.x,right:o.x+o.width,zoom:t.zoom}});e.time.addEvent({delay:n,loop:!0,callback:()=>{const{x:e,y:n}=t.worldView,s=t.zoom;e===a&&n===i&&s===r||(a=e,i=n,r=s,l())}}),e.time.addEvent({delay:s,loop:!0,callback:l})}(y),y.__cameraMonitorSetup=!0),y.__balanceMonitorSetup||(!function(e){const t=e?.stateManager?.selfPlayer?.coinInventory;if(!t||!t.$items)return;let n=new Map;for(const[e,s]of t.$items.entries())n.set(s.currencyId,s.balance);const s=[];for(const[e,n]of t.$items.entries())s.push({currencyId:n.currencyId,balance:n.balance});s.length>0&&window.postMessage({type:"BALANCE_CHANGE",data:s});const a=()=>{const e=[];for(const[s,a]of t.$items.entries()){const t=a.balance,s=a.currencyId;n.get(s)!==t&&(e.push({currencyId:s,balance:t}),n.set(s,t))}e.length>0&&window.postMessage({type:"BALANCE_CHANGE",data:e})};e.time.addEvent({delay:100,loop:!0,callback:a})}(y),y.__balanceMonitorSetup=!0),y.__landMonitorSetup||(!function(e){const t=e?.stateManager;if(!t)return;const n=["producer","crafting","business","petcare","total"];let s={mapId:"",landAttributes:new Map};const a=()=>{const e={mapId:t.mapId,landAttributes:new Map};let a=s.mapId!==e.mapId;for(const i of n){const n=t.mapLimits?.$items?.get(i);if(n){const{max:t,used:r}=n;e.landAttributes.set(i,{max:t,used:r});const o=s.landAttributes.get(i);o&&o.max===t&&o.used===r||(a=!0)}}a&&(s=e,window.postMessage({type:"LAND_CHANGE",data:{mapId:e.mapId,landAttributes:Array.from(e.landAttributes.entries()).map((([e,{max:t,used:n}])=>({attribute:e,max:t,used:n})))}}))};e.time.addEvent({delay:100,loop:!0,callback:a})}(y),y.__landMonitorSetup=!0),y.__inventoryMonitorSetup||(!function(e){const t=e?.stateManager;if(!t)return;let n=null;const s=()=>{const t=e.stateManager.selfPlayer?JSON.parse(JSON.stringify(e.stateManager.selfPlayer.inventory)):null;if(!t||!t.slots)return;const s={activeRow:t.activeRow??null,size:t.size??null,items:Object.entries(t.slots).map((([e,t])=>({slot:Number(e),item:t.item,quantity:t.quantity,state:t.state||null})))};n&&JSON.stringify(n)===JSON.stringify(s)||(n=s,window.postMessage({type:"INVENTORY_CHANGE",data:s}))};e.time.addEvent({delay:100,loop:!0,callback:s})}(y),y.__inventoryMonitorSetup=!0),y.__entityMonitorSetup||(!function(e){const t=e?.stateManager;if(!t)return;let n=null,r=null,o=null;const u=()=>{const u=e.entities?JSON.parse(JSON.stringify(Array.from(e.entities.entries()).filter((([e,t])=>s.some((e=>t.element.startsWith(e))))).map((([e,t])=>{const n=t.currentState||{},s=n?.statics?Object.values(n.statics).find((e=>"soilTier"===e.name)):null,a=n?.statics?Object.values(n.statics).find((e=>"maturetime"===e.name)):null,i=n?.displayInfo?.utcTarget??null,r=n?.statics?Object.values(n.statics).find((e=>"finishTime"===e.name)):null,o={s:n?.state||null};return r&&r.value>i?o.fT=Math.round(r.value):i&&(o.fT=Math.round(i)),s&&(o.sT=s.value),a&&(o.mT=a.value),{e:t.element,cS:o}})))):null;if(!u)return;const d=t?.room?.state;if(!d)return;const m=d.id,p=d.labels?.$items?.get(0)||null,f=d.guild?d.guild:null,y=d.levels?.$items?Object.fromEntries(Array.from(d.levels.$items.entries()).map((([e,t])=>[e,t.level]))):{},g=d.permissions?.use?Array.from(d.permissions.use.$items.values()):[],v=d.nft?.traits?Object.fromEntries(Object.entries(d.nft.traits)):{},h=d.storage?.size??0,_=d.storage?.slots?.$items?Array.from(d.storage.slots.$items.entries()).map((([e,t])=>({slot:parseInt(e,10),item:t.item,quantity:t.quantity}))):[],w=d.members?.$items?Object.fromEntries(Array.from(d.members.$items.entries()).map((([e,t])=>[t.member,t.roles?.$items?Array.from(t.roles.$items.values()).slice(0,1).map((e=>"BLOCK"===e?"BLOCK":"Builder")):[]]))):{},S={...l({levels:y,permissions:g,traits:v}),storage:{size:h,items:_},guild:f,members:w},b={id:m,entities:u,landInfo:S};n&&JSON.stringify(n)===JSON.stringify(b)||(n=b,window.postMessage({type:"LAND_DATA_CHANGE",data:b}));const A=e.playerId,M=e?.selfPlayer?.playerData?.kind,E={landId:m,timers:e.entities?Array.from(e.entities.entries()).filter((([e,t])=>Object.keys(a).some((e=>t.element.startsWith(e))))).map((([e,t])=>{const n=Object.keys(a).find((e=>t.element.startsWith(e))),s=a[n];if(s?.vipRequired&&"vip"!==M)return null;const r=s?.timerKey;let o=null,l=null,c=t.currentState?.state??null;if(null==c||s?.idleState&&c===s.idleState)return null;if(r)if("utcRefresh"===r)o=t.currentState?.utcRefresh??null;else{const[e,n]=r.split(":");if("displayInfo"===e){const e=t.currentState?.displayInfo?.[n];o=void 0!==e?Number(e):null}else if("trackers"===e){const e=t.currentState?.trackers?.find((e=>e.name===n)),s=e?.value;o=void 0!==s?Number(s):null}}s?.valueKey&&(l=function(e,t){const n=t.split(":");let s=e;for(let e=0;e<n.length;e++){const t=n[e];if("number"===t){if("string"==typeof s){const e=s.match(/\d+(\.\d+)?/g);return e&&e.length>0?Number(e[0]):null}if(Array.isArray(s)){for(const e of s)if("string"==typeof e){const t=e.match(/\d+(\.\d+)?/g);if(t&&t.length>0)return Number(t[0])}return null}return null}if(("statics"===n[e-1]||"trackers"===n[e-1])&&Array.isArray(s)){const e=s.find((e=>e.name===t));s=e?e.value:null;continue}const a=Number(t);if(!isNaN(a)&&Array.isArray(s))s=s[a];else{if(!s||"object"!=typeof s)return null;s=s[t]}}return s}(t.currentState,s.valueKey)),null!==l&&""!==l||void 0===s?.defaultValue||(l=s.defaultValue);const u=s?.setLocation??m;if(s?.alwaysUpdate)return{key:e,element_name:n,timeResolved:o,class:s.class,valueResolved:l,state:c,landId:u,landType:p};if(s?.activeKey){const[a,i]=s.activeKey.split(":");let r=null;if("statics"===a){const e=t.currentState?.statics?.find((e=>e.name===i));r=e?.value}if(void 0!==s.finishedState&&c===s.finishedState&&(o=0),r===A||"crafting"===s.class&&null!==l&&""!==l||void 0!==s.readyState&&c===s.readyState)return{key:e,element_name:n,timeResolved:o,class:s.class,valueResolved:l,state:c,landId:u,landType:p}}return i.hasOwnProperty(u)&&null!=l&&""!==l?{key:e,element_name:n,timeResolved:o,class:s.class,valueResolved:l,state:c,landId:u,landType:p}:null})).filter(Boolean):[]};r&&JSON.stringify(r)===JSON.stringify(E)||!document.querySelector(c)||(r=E,window.postMessage({type:"TIMER_DATA_CHANGE",data:E}));const N={entities:e.entities?Array.from(e.entities.entries()).filter((([e,t])=>Object.entries(a).some((([e,n])=>t.element.startsWith(e)&&n.highlightEntity)))).map((([e,t])=>{const n=Object.keys(a).find((e=>t.element.startsWith(e))),s=a[n]?.timerKey,i=t.currentState??{},r=(i.displayInfo,i.trackers,i.statics??[]),o=i.state??null,l=r.find((e=>"reservedBy"===e.name)),c=r.find((e=>"reservedUntil"===e.name)),u=r.find((e=>"user"===e.name)),d=l?.value??null,m=void 0!==c?.value?Number(c.value):null,p=u?.value??null;let f=null;if(s)if("utcRefresh"===s)f=t.currentState?.utcRefresh??null;else{const[e,n]=s.split(":");if("displayInfo"===e){const e=t.currentState?.displayInfo?.[n];f=void 0!==e?Number(e):null}else if("trackers"===e){const e=t.currentState?.trackers?.find((e=>e.name===n)),s=e?.value;f=void 0!==s?Number(s):null}}return{key:e,element_name:n,timeResolved:f,state:o,reservedBy:d,reservedUntil:m,user:p,position:{x:t.position.x,y:t.position.y,width:t.width,height:t.height}}})).filter(Boolean):[]};o&&JSON.stringify(o)===JSON.stringify(N)||!document.querySelector(c)||(o=N,window.postMessage({type:"H_ENTITIES_DATA_CHANGE",data:N}))};e.time.addEvent({delay:400,loop:!0,callback:u})}(y),y.__entityMonitorSetup=!0),y.__MSMonitorSetup||(!function(e){let t=[];const n=()=>{if(u){const e=document.querySelector(u);if(e){const n=Object.keys(e).find((e=>e.startsWith("__reactFiber$")));if(n){const s=(e[n]?.memoizedProps?.children||[]).flatMap((e=>Array.isArray(e)?e.map((e=>e?.props?.order)).filter(Boolean):e?.props?.order?[e.props.order]:[]));t.length&&JSON.stringify(t)===JSON.stringify(s)||(t=s,s.length>0&&window.postMessage({type:"MS_DATA_CHANGE",data:s}))}}}};e.time.addEvent({delay:100,loop:!0,callback:n})}(y),y.__MSMonitorSetup=!0),!y.__roomMessageListenerSetup){const e=y?.stateManager?.room;e&&(y.__roomMessageListenerSetup=!0,function(e){e.onMessage(r,(e=>{e?.gachaId&&e.gachaId.startsWith(o)&&window.postMessage({type:"MS_REWARDS",data:e})}))}(e))}const n=function(e){let t=[];if(e.scene.scenes[1]){const n=e.scene.scenes[1],s=n.playerId,a=n.stateManager.selfPlayer?n.stateManager.selfPlayer.farms:null;let i=null,r=null;a&&a.$items&&(i=a.$items.get(0),r=a.$items.get(1));const o=n.stateManager.mapId,l=o.match(/\d+/);let c,u=l?l[0]:"unknown";c=o&&""!==o.trim()?i&&o.includes(i)?`speck-farm-${u}`:r&&o.includes(r)?`speck-house-${u}`:o.includes("House")?`${u}-house`:o.includes("Farm")?`${u}-farm`:o:"unknown";const d=n.stateManager.selfPlayer?n.stateManager.selfPlayer.inventory:null;let m=null;if(d){const e=d.size,t=d.activeRow,n=d.slots.$items,s=[];n.forEach(((e,t)=>{s.push({slot:t,item:e.item,quantity:e.quantity})})),m={size:e,activeRow:t,items:s}}let p=0;if(n?.stateManager?.selfPlayer?.coinInventory){const e=n.stateManager.selfPlayer.coinInventory;if(e.$items)for(const[t,n]of e.$items.entries())if("cur_coins"===n.currencyId){p=n.balance;break}}t={playerId:s,location:c,inventoryData:m,coinBalance:p}}return t}(m);n.inventoryData&&window.postMessage({type:"VOXELS_INV_DATA",data:n.inventoryData});try{const e=function(e){const t=[];if(e.scene.scenes[1]){const n=e.scene.scenes[1],s=n.playerId,a=n.entities,i=new Map;a.forEach(((e,n)=>{e&&e.owner===s&&e.element&&(e.element.includes("storage_box")||e.element.includes("woodchest")||e.element.includes("storageChest")||e.element.includes("moca_storage")||e.element.includes("xmasStorage")||e.element.includes("halloween_2024_storage"))&&e.owner===s&&t.push(e.mid)}));const r=Array.from(i,(([e,t])=>({element:e,count:t})));let o=null;return"roomcavehub"===n.sys?.config&&(o=[],a.forEach(((e,t)=>{if(e.element&&["ent_guano_mixer","ent_spore_chamber","ent_goo_pot"].includes(e.element)&&e.currentState?.trackers){const t=(n=e.currentState)?{...n,trackers:d(n.trackers)}:null;o[e.element]={...t.trackers,state:t.state,x:e.x||null,y:null!=e.position?.y&&null!=e.height?e.position.y+e.height:null}}var n}))),{storages:t,entities_map:r,itemMixers:o}}return[]}(m),t=function(e,t){const n=t.scene.scenes[1];if(!n.stateManager||!n.stateManager.selfPlayer||!n.stateManager.selfPlayer.entities)return[];const s=n.stateManager.selfPlayer.entities.$items,a=n.entities;return e.map((e=>{const t=s.get(e),n=a.get(e);if(t&&t.storage){const s={mid:e,size:t.storage.size,items:[],position:n?{x:n.position.x,y:n.position.y,width:n.width,height:n.height}:null};return t.storage.slots.$items.forEach(((e,t)=>{e&&e.item&&s.items.push({position:e.slot,itemName:e.item,quantity:e.quantity})})),s}if(n&&n.element&&n.element.includes("woodchest")){let t;switch(n.element){case"ent_woodchest_01":t=6;break;case"ent_woodchest_02":t=12;break;case"ent_woodchest_03":t=18;break;case"ent_woodchest_04":t=24;break;default:t=0;break}if(t>0)return{mid:e,size:t,items:[],position:{x:n.position.x,y:n.position.y}}}return null})).filter((e=>null!==e))}(e.storages,m),s=m.scene.scenes[1].hoverNode;let a=null;if(s&&s.propCache){let e=s.element?s.element:null;s.propCache.id?a={id:s.propCache.id,owner:s.propCache.owner,name:e}:s.playerData&&"pet"===s.playerData.kind&&(a={id:s.playerData.kind,owner:s.propCache.owner,name:e})}const i={},r=function(e){const t=e.scene.scenes[1]?.stateManager?.selfPlayer?.pet;if(t&&t.inventory){const e=t.inventory.slots,n=[];return e.$items.forEach((e=>{e&&e.item&&n.push({position:e.slot,itemName:e.item,quantity:e.quantity||0})})),{size:t.inventory.size,items:n}}return null}(m);JSON.stringify(t)!==JSON.stringify(p)&&(i.storages=t,p=t),i.hoverNode=a,i.inventory=n.inventoryData||null,i.location=n.location||null,i.coinBalance=n.coinBalance||null,i.petInventory=r||null,i.itemMixers=e.itemMixers||null,Object.keys(i).length>0&&window.postMessage({type:"VOXELS_GAME_DATA",data:i})}catch(e){}}setTimeout(f,200)}()}));let m=[];function p(e){const t=document.querySelector(e);if(t){const e=Object.keys(t).find((e=>e.startsWith("__reactFiber$")));if(e){const a=t[e]?.memoizedProps;if(a&&a.children&&Array.isArray(a.children[0])){const e=a.children[0].map((e=>e.props)).map(((e,t)=>{if(e.request&&e.request.item){const n=e.request.item||{},s=e.reward.currency||{},a=e.reward.skill||{};let i;switch(e.playerClassId){case"f2p":i="Basic";break;case"vip":i="VIP";break;case"landowner":i="Landowner";break;default:i="Unknown"}return{position:t,type:i,name:n.name||"N/A",tier:n.tier||"N/A",quantity:e.request.quantity||"N/A",canFill:e.canFill||!1,rewardCurrency:s.currencyId||"coins",rewardAmount:s.amount||"N/A",skillType:a.skillType||"N/A",skillXp:a.xp||"N/A"}}{const n=e.cooldownEndTimestamp;return{position:t,type:"Unknown",itemName:"Loading...",reloadTimestamp:Math.floor(n/1e3)}}}));n=e,s=m,JSON.stringify(n)!==JSON.stringify(s)&&(m=e,window.postMessage({type:"VOXELS_TASK_DATA",value:e},"*"))}}}var n,s}window.addEventListener("message",(function(e){if("VOXELS_NODE_INPAGE"===e.data.type){const t=e.data.value;t.hudTopLeft&&(c=t.hudTopLeft),t.taskContent&&setInterval((()=>p(t.taskContent)),200),t.MS&&(u=t.MS),t.msMessage&&(r=t.msMessage),t.msGachaId&&(o=t.msGachaId)}}));let f=null;!function(){const e=document.body;new MutationObserver((e=>{for(const t of e)if("childList"===t.type){const e=document.querySelector(".MarketplaceItemListings_content__eeHjR");if(e){const t=Object.keys(e).find((e=>e.includes("__reactProps$")));if(t){const n=e[t]?.children?.[1]?.props?.item?.id;n&&f!==n&&(f=n,window.postMessage({type:"VOXELS_MARKET_ITEM",data:f}))}}else null!==f&&(f=null)}})).observe(e,{childList:!0,subtree:!0})}()}();