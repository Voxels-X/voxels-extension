let historic_prices=null;const historic_item_prices=e=>historic_prices?.[e]??null;function getHistoricData(){chrome.storage.local.get("pid",(async function(e){const t={pid:e.pid,operation:"getHistoricData"};try{const e=await makeRequestToTools(t);if(!e||!e.data)return;historic_prices=e.data}catch(e){}}))}function loadNetworth(e,t=""){premium?chrome.storage.local.get("pid",(async function(e){const n={pid:e.pid,operation:"getEntities"};loadingScreen(1);try{const e=await makeRequestToTools(n);if(loadingScreen(0),!e||!e.data)return void quickMessage("Please try again later","error");updateAutoUpdateLocations(e.data),loadNetworthPage(e.data,t)}catch(e){}})):displayPremium()}function updateAutoUpdateLocations(e){if(!e||"object"!=typeof e)return;const t=e.entities?Object.keys(e.entities):[],n=e.storages?Object.keys(e.storages):[],o=[...new Set([...t,...n])];autoUpdateLocations=o.filter((e=>"total_value"!==e)).map((e=>e.toString()))}function getToolsLands(){chrome.storage.local.get("pid",(async function(e){const t={pid:e.pid,operation:"getLands"};try{const e=await makeRequestToTools(t);if(!e||!e.data)return;autoUpdateLocations=e.data.lands.map(String)||[]}catch(e){}}))}let storedItemCache=null;function initialStorageFetch(){chrome.storage.local.get("pid",(async function(e){const t={pid:e.pid,operation:"getStorages"};try{const e=await makeRequestToTools(t);if(!e||!e.data)return;e.data.lands&&(handleT4Data(e.data.lands,"storages"),storedItemCache=e.data.lands)}catch(e){}}))}function loadNetworthPage(e,t=""){if("object"==typeof e&&e.hasOwnProperty("error")){switch(e.error){case"12001":networthContainer.textContent="Error: Premium credentials are invalid or expired. Please renew your subscription.";break;case"12002":displayPageInfo("Secure Voxels","To access the networth page, please secure your account in the settings. Click here for settings.",chrome.runtime.getURL("images/Other/secure_account.png"),(function(){switchFullPage("settings")}));break;default:networthContainer.textContent="Error: An unknown issue occurred. Please try again later.";break}return networthContainer}reloadOverlay();document.querySelector(".voxels-main").appendChild(addNetworthContent(e,t)).classList.add("active")}function addNetworthContent(e,t=""){var n=document.createElement("div");n.classList.add("voxels-networth-page");var o=document.createElement("div");o.classList.add("voxels-networth-header");var a=document.createElement("div");a.classList.add("voxels-networth-header-stats","hidden");var i=document.createElement("div");i.classList.add("voxels-networth-header-stats-sub-statistics");var s=e.storages.total_value,r=e.entities.total_value,d=e.market_listings.total_value,c=document.createElement("div");c.classList.add("voxels-networth-header-stats-sub-statistics-coinbalance"),i.appendChild(c);var l=document.createElement("div");l.classList.add("voxels-networth-header-stats-sub-statistics-item-title"),l.innerText="Coin Balance",c.appendChild(l);var m=document.createElement("div");m.classList.add("voxels-networth-header-stats-sub-statistics-item-number"),m.innerText=`${nFormatter(currentCoinBalance,1)}`,c.appendChild(m);var p=document.createElement("div");p.classList.add("voxels-networth-header-stats-sub-statistics-inventoryvalue"),i.appendChild(p);var u=document.createElement("div");u.classList.add("voxels-networth-header-stats-sub-statistics-item-title"),u.innerText="Inventory Value",p.appendChild(u);var h=document.createElement("div");if(h.classList.add("voxels-networth-header-stats-sub-statistics-item-number"),h.innerText=`${nFormatter(inventoryValue,1)}`,p.appendChild(h),petInventoryValue>0){var v=document.createElement("div");v.classList.add("voxels-networth-header-stats-sub-statistics-petinventoryvalue"),i.appendChild(v);var g=document.createElement("div");g.classList.add("voxels-networth-header-stats-sub-statistics-item-title"),g.innerText="Pet Inventory Value",v.appendChild(g);var L=document.createElement("div");L.classList.add("voxels-networth-header-stats-sub-statistics-item-number"),L.innerText=`${nFormatter(petInventoryValue,1)}`,v.appendChild(L),L.prepend($())}var x=document.createElement("div");x.classList.add("voxels-networth-header-stats-sub-statistics-storagestotal"),i.appendChild(x);var f=document.createElement("div");f.classList.add("voxels-networth-header-stats-sub-statistics-item-title"),f.innerText="Storages",x.appendChild(f);var w=document.createElement("div");w.classList.add("voxels-networth-header-stats-sub-statistics-item-number"),w.innerText=`${nFormatter(s,1)}`,x.appendChild(w);var C=document.createElement("div");C.classList.add("voxels-networth-header-stats-sub-statistics-entitiestotal"),i.appendChild(C);var y=document.createElement("div");y.classList.add("voxels-networth-header-stats-sub-statistics-item-title"),y.innerText="Entities",C.appendChild(y);var E=document.createElement("div");E.classList.add("voxels-networth-header-stats-sub-statistics-item-number"),E.innerText=`${nFormatter(r,1)}`,C.appendChild(E);var b=document.createElement("div");b.classList.add("voxels-networth-header-stats-sub-statistics-marketlistingsvalue"),i.appendChild(b);var k=document.createElement("div");k.classList.add("voxels-networth-header-stats-sub-statistics-item-title"),k.innerText="Market Listings",b.appendChild(k);var _=document.createElement("div");_.classList.add("voxels-networth-header-stats-sub-statistics-item-number"),_.innerText=`${nFormatter(d,1)}`,b.appendChild(_);var T=document.createElement("div");T.classList.add("voxels-networth-header-stats-main-statistic");var S=document.createElement("h2");S.classList.add("voxels-networth-header-stats-main-statistic-name"),S.textContent="Networth",T.appendChild(S);var F=document.createElement("span");function $(){const e=document.createElement("img");return e.src=chrome.runtime.getURL("/images/Prices/coin.png"),e.alt="Coin Icon",e.classList.add("coin-image"),e}F.classList.add("voxels-networth-header-stats-main-statistic-number"),m.prepend($()),h.prepend($()),w.prepend($()),E.prepend($()),_.prepend($());let q="0";if(e.total_value){let t=e.total_value;inventoryValue>0&&(t+=inventoryValue),petInventoryValue>0&&(t+=petInventoryValue),currentCoinBalance>0&&(t+=currentCoinBalance),q=nFormatter(t,3)}F.textContent=q,F.append($()),T.prepend(F);var N=document.createElement("div");N.classList.add("voxels-networth-header-stats-expand-btn","clickable"),N.addEventListener("click",(function(){a.classList.toggle("hidden")})),T.appendChild(N),a.appendChild(T),a.appendChild(i),o.appendChild(a);var A=e.market_listings;const I=Object.keys(A).slice(0,-1).map((e=>{const t=A[e],n=getNameForItem(e),o=getImageForItem(e),{quantity:a,price:i,total_price:s}=t;return{itemName:n,itemImage:o,quantity:a,price:i,total_price:s}})).sort(((e,t)=>t.total_price-e.total_price)).slice(0,5);b.addEventListener("mouseenter",(()=>{hoverContainer=document.createElement("div"),hoverContainer.classList.add("voxels-networth-marketlistings-modal"),document.body.appendChild(hoverContainer);let e="";e=I.length>0?I.map((({itemName:e,itemImage:t,quantity:n,total_price:o})=>`\n                    <div class="voxels-networth-marketlistings-modal-item">\n                        <div class="voxels-networth-marketlistings-modal-item-icon">\n                            <img class="voxels-networth-entity-image" src="${t}" />\n                            <div class="voxels-networth-entity-count">x${nFormatter(n,0)}</div>\n                        </div>\n                        <div class="voxels-networth-marketlistings-modal-item-name">${e}</div>\n                        <div class="voxels-networth-marketlistings-modal-item-price">\n                            <img src="${chrome.runtime.getURL("/images/Prices/coin.png")}" alt="Coin Icon" class="coin-image">\n                            ${nFormatter(o,1)}\n                        </div>\n                    </div>\n                    `)).join(""):'\n                <div class="voxels-networth-marketlistings-modal-empty-content">\n                    No listings (updates every 5 mins)\n                </div>\n                ',hoverContainer.innerHTML='\n                <div class="voxels-networth-marketlistings-modal-title">\n                    Top Market Listings\n                </div>\n            '+e;const t=b.getBoundingClientRect(),n=t.left+t.width/2;hoverContainer.style.position="absolute";const o=hoverContainer.offsetWidth,a=hoverContainer.offsetHeight;let i=n-o/2,s=t.top-a-5;const r=window.innerWidth;window.innerHeight;i<0&&(i=5),i+o>r&&(i=r-o-5),s<0&&(s=t.bottom+5),hoverContainer.style.left=`${i}px`,hoverContainer.style.top=`${s}px`;const d=()=>{hoverContainer&&hoverContainer.remove(),b.removeEventListener("mouseleave",d)};b.addEventListener("mouseleave",d)}));var R=document.createElement("div");R.classList.add("voxels-networth-header-tools");var P=document.createElement("div");P.classList.add("voxels-networth-add-btn","clickable"),R.appendChild(P);const H=limiter(addNewLandAndStorageToNetworth,1e4);return P.addEventListener("click",(function(){H()})),o.appendChild(R),n.appendChild(o),loadFilterNetworth(n,t),e.entities&&delete e.entities.total_value,e.storages&&delete e.storages.total_value,loadLands(n,e),loadLandSearch(n),n}function loadLandSearch(e){var t=document.createElement("div");t.classList.add("voxels-main-button");var n=document.createElement("div");n.classList.add("voxels-main-button-text","clickable"),n.textContent="Search for industries...",t.appendChild(n);const o=limiter((function(){requestLandSearch()}),1e4);n.addEventListener("click",(function(){o()})),e.appendChild(t)}function loadFilterNetworth(e,t=""){var n=document.createElement("div");n.classList.add("voxels-networth-filter-container");var o=document.createElement("input");function a(){const t=o.value.toLowerCase();e.querySelectorAll(".voxels-networth-collection-item").forEach((e=>{const n=e.getAttribute("data-collection-item-name").toLowerCase();""===t||n.includes(t)?e.classList.remove("voxels-networth-item-hidden"):e.classList.add("voxels-networth-item-hidden")})),i()}function i(){e.querySelectorAll(".voxels-networth-land").forEach((e=>{const t=e.querySelectorAll(".voxels-networth-collection-item"),n=Array.from(t).filter((e=>!e.classList.contains("voxels-networth-item-hidden")));e.style.display=0===n.length?"none":""}));e.querySelectorAll(".voxels-networth-location").forEach((e=>{const t=e.querySelectorAll(".voxels-networth-collection-item"),n=Array.from(t).filter((e=>!e.classList.contains("voxels-networth-item-hidden")));if(0===n.length)e.style.display="none";else{e.style.display="";const t=e.querySelector(".voxels-toggle-button");n.length>5?(n.slice(5).forEach((e=>{e.classList.add("voxels-networth-item-hidden")})),t.style.display="flex"):t.style.display="none"}}))}o.setAttribute("type","text"),o.setAttribute("placeholder","Search..."),o.classList.add("voxels-filter-input"),o.value=t,n.appendChild(o),e.appendChild(n),o.addEventListener("input",(function(e){a(),i(),Array.from(document.querySelectorAll(".voxels-toggle-button")).forEach((e=>{e.classList.remove("expanded"),e.classList.add("collapsed"),e.innerText="Show More"})),e.stopPropagation()})),o.addEventListener("keydown",(function(e){o===document.activeElement&&e.stopPropagation()})),t&&setTimeout(a,0)}function loadLands(e,t){const n={};for(const e in t.entities){const o=t.entities[e];n[e]=n[e]||{},n[e].total_price=o.total_price;for(const a in o){const i=o[a].entities||[];if(n[e][a]=n[e][a]||{},n[e][a].entities=i,n[e][a].entities_total_price=o[a].total_price,t.storages[e]&&t.storages[e][a]){const o=t.storages[e][a].items||[];n[e][a].storages=o;const i=t.storages[e][a].total_price||0;n[e][a].storages_total_price=i,n[e].total_price+=i}}}for(const e in t.storages){n[e]=n[e]||{};for(const o in t.storages[e])if(n[e][o]=n[e][o]||{},!n[e][o].storages){const a=t.storages[e][o].items||[];n[e][o].storages=a,n[e].total_price=(n[e].total_price||0)+(t.storages[e][o].total_price||0),n[e][o].storages_total_price=t.storages[e][o].total_price||0}}appendLands(e,n)}function appendLands(e,t){for(const[m,p]of Object.entries(t)){var n=document.createElement("div");n.classList.add("voxels-networth-land"),n.setAttribute("data-land-number",m);var o=document.createElement("div");let t;t="mocaclub"===m?"Moca Club":"PostOfficeInterior"===m?"Post Office":"DrunkenGooseInterior"===m?"Drunken Goose":m.charAt(0).toUpperCase()+m.slice(1);let u=nFormatter(p.total_price,1);o.textContent=`${t}`,o.classList.add("voxels-networth-land-number");var a=document.createElement("div");a.classList.add("voxels-networth-land-container"),a.innerText=`${u}`,o.appendChild(a);var i=document.createElement("img");i.classList.add("voxels-networth-land-number-icon"),i.src=chrome.runtime.getURL("/images/Prices/coin.png"),a.prepend(i);var s=document.createElement("div");s.classList.add("voxels-networth-land-tools");var r=document.createElement("div");r.classList.add("voxels-networth-refresh-btn","clickable");var d=document.createElement("img");d.classList.add("voxels-networth-refresh-btn-icon"),d.src=chrome.runtime.getURL("/images/icons/icon__refresh.svg"),r.appendChild(d);const h=limiter((function(){updateLandEntities(m)}),1e4);r.addEventListener("click",(function(){h()}));var c=document.createElement("div");c.classList.add("voxels-close-button","clickable");var l=document.createElement("img");l.classList.add("voxels-close-button-icon"),l.src=chrome.runtime.getURL("/images/icons/icon__delete.svg"),c.appendChild(l),c.addEventListener("click",(function(){removeLandFromNetworth(m)})),s.appendChild(r),s.appendChild(c),n.appendChild(o),n.appendChild(s),p.farm&&(addLocationEntities(n,"Farm",p.farm.entities,p.farm.entities_total_price),addLocationStorages(n,"Farm",p.farm.storages,p.farm.storages_total_price)),p.house&&(addLocationEntities(n,"House",p.house.entities,p.house.entities_total_price),addLocationStorages(n,"House",p.house.storages,p.house.storages_total_price)),e.appendChild(n)}}function toggleVisibility(e,t,n){e.forEach(((e,o)=>{o>=t&&e.classList.toggle("voxels-networth-item-hidden",!n)}))}function handleToggleButtonClick(e){const t=e.currentTarget,n=t.parentElement,o=Array.from(n.querySelectorAll(".voxels-networth-collection-item")),a=document.querySelector(".voxels-filter-input"),i=t.classList.contains("collapsed");if(a.value){toggleVisibility(o.filter((e=>e.getAttribute("data-collection-item-name").toLowerCase().includes(a.value.toLowerCase()))),5,i)}else{toggleVisibility(Array.from(n.querySelectorAll(".voxels-networth-collection-item")),5,i)}t.classList.toggle("collapsed",!i),t.classList.toggle("expanded",i),t.innerText=i?"Show Less":"Show More"}function addLocationEntities(e,t,n,o){if(!n||0===n.length)return;n.sort(((e,t)=>{const n=e.total_price||0;return(t.total_price||0)-n}));var a=document.createElement("div");if(a.classList.add("voxels-networth-location"),"Farm"===t)(i=document.createElement("img")).src=chrome.runtime.getURL("/images/pixels_icon.png"),i.classList.add("voxels-networth-location-title-icon");else if("House"===t){var i;(i=document.createElement("img")).src=chrome.runtime.getURL("/images/Other/house-1.png"),i.classList.add("voxels-networth-location-title-icon")}var s=document.createElement("div");s.classList.add("voxels-networth-location-title"),s.innerText="Entities",s.prepend(i),a.appendChild(s);const r=document.createElement("img");r.src=chrome.runtime.getURL("images/Prices/coin.png"),r.classList.add("voxels-networth-price-icon");var d=document.createElement("div");d.classList.add("voxels-networth-location-title-price"),d.innerText=`${nFormatter(o,1)}`,d.prepend(r),s.appendChild(d);var c=document.createElement("div");c.classList.add("voxels-networth-content");let l=0;const m=document.createElement("div");m.classList.add("voxels-toggle-button","clickable","collapsed"),m.id="toggleVisibility",m.innerText="Show More",m.addEventListener("click",handleToggleButtonClick),n.forEach((e=>{var t=document.createElement("div");t.classList.add("voxels-networth-entity","voxels-networth-collection-item"),t.setAttribute("data-collection-item-name",getNameForItem(e.item)),l>=5&&t.classList.add("voxels-networth-item-hidden"),l++;const n=getImageForItem(e.item);var o=document.createElement("img");o.src=n||"https://pixels-api.com/images/item_not_found.png",o.classList.add("voxels-networth-entity-image");var a=e.count,i=document.createElement("div");if(i.textContent="x"+nFormatter(a,1),i.classList.add("voxels-networth-entity-count"),e.price){var s=document.createElement("div");s.classList.add("voxels-networth-price"),s.innerText=`${nFormatter(e.price,1)}`;const n=document.createElement("img");n.src=chrome.runtime.getURL("images/Prices/coin.png"),n.classList.add("voxels-networth-price-icon"),s.appendChild(n),t.appendChild(s)}t.addEventListener("mouseenter",(()=>{const n=document.createElement("div");n.classList.add("voxels-networth-hover");const o=getNameForItem(e.item),i=findRecipe(e.item),s=a*(e.price||0),r=nFormatter(s,1),d=e.price||0,c=nFormatter(d,1),l=document.createElement("div");l.classList.add("voxels-networth-hover-name"),l.textContent=o;const m=document.createElement("div");m.classList.add("voxels-networth-hover-price"),m.innerHTML=`${a} x ${c} = ${r}`;const p=document.createElement("img");if(p.src=chrome.runtime.getURL("images/Prices/coin.png"),p.classList.add("voxels-networth-price-icon"),m.innerHTML=`${a} x `,m.appendChild(p),m.innerHTML+=` ${c} = `,m.appendChild(p.cloneNode()),m.innerHTML+=` ${r}`,n.appendChild(l),n.appendChild(m),displayHoverInfo){if(null!==i){const e=createRecipeContainer(i);n.appendChild(e)}const t=historic_item_prices(e.item);if(t){const o=document.createElement("div");o.classList.add("voxels-networth-hover-graph-container");const a=document.createElement("div");a.classList.add("voxels-networth-hover-graph-header"),a.textContent="7-day Graph",o.appendChild(a);let i=[...t];if(marketPrices[e.item]){const t=marketPrices[e.item],n=Math.floor(Date.now()/1e3);i.push({t:n,p:t})}const s=renderPriceChart(i);o.appendChild(s),n.appendChild(o)}}document.body.appendChild(n);const u=t.getBoundingClientRect(),h=u.left+u.width/2,v=n.offsetWidth,g=n.offsetHeight;let L=h-v/2,x=u.top-g-5;const f=window.innerWidth;window.innerHeight;L<0&&(L=5),L+v>f&&(L=f-v),x<0&&(x=5),n.style.position="absolute",n.style.left=`${L}px`,n.style.top=`${x}px`,currentItemHovered=e.item,itemHoverLoop()})),t.addEventListener("mouseleave",(function(){document.querySelectorAll(".voxels-networth-hover").forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)})),currentItemHovered=null})),t.appendChild(o),t.appendChild(i),c.appendChild(t)}));Array.from(c.querySelectorAll(".voxels-networth-entity")).length>5?m.style.display="flex":m.style.display="none",c.appendChild(m),a.appendChild(c),e.appendChild(a)}function addLocationStorages(e,t,n,o){if(!n||0===n.length)return;n.sort(((e,t)=>{const n=e.total_price||0;return(t.total_price||0)-n}));var a=document.createElement("div");if(a.classList.add("voxels-networth-location"),"Farm"===t)(i=document.createElement("img")).src=chrome.runtime.getURL("/images/pixels_icon.png"),i.classList.add("voxels-networth-location-title-icon");else if("House"===t){var i;(i=document.createElement("img")).src=chrome.runtime.getURL("/images/Other/house-1.png"),i.classList.add("voxels-networth-location-title-icon")}var s=document.createElement("div");s.classList.add("voxels-networth-location-title"),s.innerText="Storages",s.prepend(i),a.appendChild(s);const r=document.createElement("img");r.src=chrome.runtime.getURL("images/Prices/coin.png"),r.classList.add("voxels-networth-price-icon");var d=document.createElement("div");d.classList.add("voxels-networth-location-title-price"),d.innerText=`${nFormatter(o,1)}`,d.prepend(r),s.appendChild(d);var c=document.createElement("div");c.classList.add("voxels-networth-content");let l=0;const m=document.createElement("div");m.classList.add("voxels-toggle-button","collapsed"),m.id="toggleVisibility",m.innerText="Show More",m.addEventListener("click",handleToggleButtonClick),n.forEach((e=>{var t=document.createElement("div");t.classList.add("voxels-networth-storage","voxels-networth-collection-item"),t.setAttribute("data-collection-item-name",getNameForItem(e.item)),l>=5&&t.classList.add("voxels-networth-item-hidden"),l++;const n=getImageForItem(e.item);var o=document.createElement("img");o.src=n||"https://pixels-api.com/images/item_not_found.png",o.classList.add("voxels-networth-storage-image");var a=e.count,i=document.createElement("div");if(i.textContent="x"+nFormatter(a,1),i.classList.add("voxels-networth-storage-count"),e.price){var s=document.createElement("div");s.classList.add("voxels-networth-price"),s.innerText=`${nFormatter(e.price,1)}`;const n=document.createElement("img");n.src=chrome.runtime.getURL("images/Prices/coin.png"),n.classList.add("voxels-networth-price-icon"),s.appendChild(n),t.appendChild(s)}t.appendChild(o),t.appendChild(i),t.addEventListener("mouseenter",(()=>{const n=document.createElement("div");n.classList.add("voxels-networth-hover");const o=getNameForItem(e.item),i=findRecipe(e.item),s=a*(e.price||0),r=e.price||0,d=nFormatter(r,1),c=nFormatter(s,1),l=document.createElement("div");l.classList.add("voxels-networth-hover-name"),l.textContent=o;const m=document.createElement("div");m.classList.add("voxels-networth-hover-price"),m.textContent=`Total: ${a} x ${d} = ${c}`;const p=document.createElement("img");if(p.src=chrome.runtime.getURL("images/Prices/coin.png"),p.classList.add("voxels-networth-price-icon"),m.innerHTML=`${a} x `,m.appendChild(p),m.innerHTML+=` ${d} = `,m.appendChild(p.cloneNode()),m.innerHTML+=` ${c}`,n.appendChild(l),n.appendChild(m),displayHoverInfo){if(null!==i){const e=createRecipeContainer(i);n.appendChild(e)}const t=historic_item_prices(e.item);if(t){const o=document.createElement("div");o.classList.add("voxels-networth-hover-graph-container");const a=document.createElement("div");a.classList.add("voxels-networth-hover-graph-header"),a.textContent="7-day Graph",o.appendChild(a);let i=[...t];if(marketPrices[e.item]){const t=marketPrices[e.item],n=Math.floor(Date.now()/1e3);i.push({t:n,p:t})}const s=renderPriceChart(i);o.appendChild(s),n.appendChild(o)}}document.body.appendChild(n);const u=t.getBoundingClientRect(),h=u.left+u.width/2,v=n.offsetWidth,g=n.offsetHeight;let L=h-v/2,x=u.top-g-5;const f=window.innerWidth;window.innerHeight;L<0&&(L=5),L+v>f&&(L=f-v-5),x<0&&(x=5),n.style.position="absolute",n.style.left=`${L}px`,n.style.top=`${x}px`,currentItemHovered=e.item,itemHoverLoop()})),t.addEventListener("mouseleave",(function(){document.querySelectorAll(".voxels-networth-hover").forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)})),currentItemHovered=null})),c.appendChild(t)}));Array.from(c.querySelectorAll(".voxels-networth-storage")).length>5?m.style.display="flex":m.style.display="none",c.appendChild(m),a.appendChild(c),e.appendChild(a)}async function removeLandFromNetworth(e){chrome.storage.local.get("pid",(async function(t){const n={pid:t.pid,operation:"removeLocation",extra:[{location:e}]};try{if("success"===(await makeRequestToTools(n)).data.status){var o=document.querySelector(`[data-land-number="${e}"]`);if(o){o.remove();const t=autoUpdateLocations.indexOf(e);-1!==t&&autoUpdateLocations.splice(t,1)}}}catch(e){}}))}function addNewLandAndStorageToNetworth(){"string"==typeof currentLand&&""!==currentLand.trim()?autoUpdateLocations.includes(currentLand)?quickMessage("This land is already being tracked.","error"):(loadingScreen(1),handleStorages(cachedStorages,currentLocation,!0)):"PostOfficeInterior"==currentLocation||"DrunkenGooseInterior"==currentLocation||"mocaclub"==currentLocation?autoUpdateLocations.includes(currentLocation)?quickMessage("This land is already being tracked.","error"):(loadingScreen(1),handleStorages(cachedStorages,currentLocation,!0)):quickMessage("Make sure you are on a valid land to start tracking.","error")}async function updateLandEntities(e){chrome.storage.local.get("pid",(async function(t){const n={pid:t.pid,operation:"updateEntities",extra:[{location:e}]};try{loadingScreen(1);const e=await makeRequestToTools(n);loadingScreen(0),e.data.status&&loadNetworth(0)}catch(e){}}))}async function requestLandSearch(){chrome.storage.local.get("pid",(async function(e){const t={pid:e.pid,operation:"searchForLands"};try{loadingScreen(1);const e=await makeRequestToTools(t);if(loadingScreen(0),e.data.status){const t=Object.keys(e.data.entities).filter((e=>!autoUpdateLocations.includes(e.toString()))).reduce(((t,n)=>(t[n]=e.data.entities[n],t)),{});if(0===Object.keys(t).length)autoUpdateLocations.includes("speck")?quickMessage("No new lands found with your entities.","info"):quickMessage("No new lands found with your entities. You may still add your speck.","info");else{const e=document.querySelector(".voxels-main-button");if(e){e.querySelector(".voxels-main-button-text")?.remove();let n=e.querySelector(".voxels-networth-found-lands");n&&n.remove(),n=document.createElement("div"),n.classList.add("voxels-networth-found-lands");const o=document.createElement("div");o.textContent="Entities found:",o.classList.add("voxels-networth-found-title"),n.appendChild(o),Object.entries(t).forEach((([e,t])=>{const o=document.createElement("div");o.classList.add("voxels-networth-found-land-row");const a=document.createElement("div");a.textContent=`${e}`,a.classList.add("voxels-found-land-number"),o.appendChild(a);const i=mapItmToNameAndImage(t,displayNamesJSONArray),s=document.createElement("div");s.classList.add("voxels-found-land-items"),i.slice(0,5).forEach((e=>{const t=document.createElement("div");t.classList.add("voxels-found-item-image-container");const n=document.createElement("img");n.src=e.image,n.title=e.displayName,n.classList.add("voxels-found-item-image"),t.addEventListener("mouseenter",(()=>{const n=document.createElement("div");n.classList.add("voxels-networth-hover");const o=getNameForItem(e.item),a=document.createElement("div");a.classList.add("voxels-networth-hover-name"),a.textContent=o,n.appendChild(a),document.body.appendChild(n);const i=t.getBoundingClientRect(),s=i.left+i.width/2,r=n.offsetWidth,d=n.offsetHeight;let c=s-r/2,l=i.top-d-5;const m=window.innerWidth;window.innerHeight;c<0&&(c=5),c+r>m&&(c=m-r),l<0&&(l=5),n.style.position="absolute",n.style.left=`${c}px`,n.style.top=`${l}px`,t.addEventListener("mouseleave",(function(){document.querySelectorAll(".voxels-networth-hover").forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}))}))})),t.appendChild(n),s.appendChild(t)})),o.appendChild(s);const r=document.createElement("div");r.classList.add("voxels-found-add-land-button"),r.onclick=()=>{updateLandEntities(e)},o.appendChild(r),n.appendChild(o)})),e.appendChild(n)}}}}catch(e){}}))}const renderPriceChart=(e,t=250,n=100)=>{const o=document.createElement("div"),a=document.createElement("canvas");a.width=t,a.height=n,o.appendChild(a);const i=e.map((e=>e.p)),s=e.map((e=>new Date(1e3*e.t).toLocaleTimeString())),r="#e3ff36";return new Chart(a,{type:"line",data:{labels:s,datasets:[{data:i,borderColor:r,backgroundColor:"rgba(227,255,54,0.2)",fill:!1,borderWidth:1,pointRadius:0,tension:.4}]},options:{responsive:!1,maintainAspectRatio:!1,animations:{duration:0},plugins:{legend:{display:!1},tooltip:{enabled:!1}},scales:{x:{display:!1},y:{position:"right",ticks:{font:{size:10,weight:"bold"},color:r,callback:(e,t,n)=>nFormatter(e,1)},beginAtZero:!1,grid:{color:"rgba(228, 255, 54,0.1)"}}}}}),o};