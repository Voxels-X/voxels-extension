function buttonListener(e){e.preventDefault();const t=document.querySelector("#username").value;t?chrome.runtime.sendMessage({message:"login",payload:{username:t}},(function(e){if("success"===e)hideError(),loadMainPage();else if("auth"===e)hideError(),loadAuthPage();else if("1041"===e){const e=document.querySelector("#username");e.value="",e.placeholder="Check your login info",e.classList.add("input_err")}else if("1701"===e){const e=document.querySelector("#username");e.value="",e.placeholder="Use auth_code to login",e.classList.add("input_err")}else{const e=document.querySelector("#username");e.value="",e.placeholder="Check your login info",e.classList.add("input_err")}})):document.querySelector("#username").classList.add("input_err")}function loadMainPage(){const e=document.querySelector(".main");document.querySelector(".main form").remove(),document.querySelector(".main #error-message").remove(),e.appendChild(document.createElement("div")).setAttribute("id","settings");let t="";chrome.storage.local.get("user_info",(function(e){t=e.user_info;document.querySelector(".title").textContent="Welcome back,";document.getElementById("userName").innerHTML=t+"!"}));var n=e.appendChild(document.createElement("button"));n.setAttribute("class","log_button"),n.type="submit",n.value="Logout",n.innerHTML="LOGOUT",n.addEventListener("click",logout)}function loadAuthPage(){const e=document.querySelector(".main");document.querySelector(".main form").remove();let t="";chrome.storage.local.get("user_info",(function(e){t=e.user_info;document.querySelector(".title").textContent="Authenticating";document.getElementById("userName").innerHTML=t})),showError("Open/Reload play.pixels.xyz and follow instructions.");var n=e.appendChild(document.createElement("button"));n.setAttribute("class","log_button"),n.type="submit",n.value="Logout",n.innerHTML="LOGOUT",n.addEventListener("click",logout)}function loadLoginPage(){const e=document.querySelector(".main");var t=document.querySelector(".main #settings");t&&t.remove();var n=document.querySelector(".main #error-message");n&&n.remove(),document.querySelector(".main .log_button").remove(),document.querySelector(".main #userName").innerHTML="",document.querySelector(".title").innerHTML="Voxels";var o=e.appendChild(document.createElement("form"));o.innerHTML='<input type="text" name="username" id="username" placeholder="Enter username from pixels" required /> <button  class="log_button" type="submit"  value="Login">LOGIN</button>',o.addEventListener("submit",(e=>buttonListener(e)));var r=e.appendChild(document.createElement("div"));r.id="error-message",r.className="hidden"}function logout(){chrome.runtime.sendMessage({message:"logout"},(function(e){"success"===e&&loadLoginPage()}))}function setStatus(){const e=document.querySelector("#switch_text").innerHTML;chrome.runtime.sendMessage({message:"Active"==e?"extension_deactivate":"extension_activate"},(function(e){if("success"===e.message){const t=e.currStatus;document.querySelector("#switch_text").innerHTML=t?"Active":"Inactive"}}))}function debugLog(e){}function showError(e){const t=document.getElementById("error-message");t.textContent=e,t.classList.remove("hidden")}function hideError(){document.getElementById("error-message").classList.add("hidden")}document.querySelector("form").addEventListener("submit",(e=>buttonListener(e))),document.addEventListener("DOMContentLoaded",(function(){chrome.runtime.sendMessage({message:"userStatus"},(function(e){if("success"===e.message){const t=e.userStatus,n=e.authStatus;t&&(n?loadMainPage():loadAuthPage())}}))}));